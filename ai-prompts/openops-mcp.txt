# App Connection Patching Guide for AI Agents

When a user wants to update an app connection (for example, to add a new AWS role), follow these steps:

---

## 1. Find the Existing Connection
- Use the **list endpoint** to find the connection by name or ID.
- Once you have the id from the prevous step, use the **get endpoint** with the connection ID to fetch the **full, current connection object**.

## 2. Prepare the Patch Request
- **Start with a copy of the entire existing connection object.**
- Only modify the specific fields the user wants to change.
- if the user requested to change a field that does not exist on the connection, find the most equivalent one and ask the user for confirmation.
- if the user requested to change something but is missing info on other REQUIRED fields, request the user to provide the other fields.
- **For arrays:**
  - If the user wants to add a new item, **append** it to the existing array (do not overwrite the array).
  - If the user wants to remove or update an item, do so as specified.
- **Do not remove or overwrite any existing fields or array items unless the user requests it.**
- The minimum required fields for the patch are:
  - `id`: The connection ID
  - `blockName`: The block name
  - All other fields as they currently exist, unless the user wants to change them.

## 3. Send the Patch Request
- Use the **patch endpoint** with the prepared request.
- The backend will handle validation, encryption, and redacted secrets.

## 4. Confirm the Update
- Return the updated connection details to the user, confirming only the requested changes were made.

---

### Important
- **Never remove or overwrite existing roles or other fields unless the user asks.**
- **Never ask the user for redacted or secret fields unless they want to change them.**
- **Always use the full, current connection object as the base for your patch.**

---
